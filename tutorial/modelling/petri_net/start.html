<!DOCTYPE html>
<html lang="en" dir="ltr" class="no-js">
<head>
    <meta charset="utf-8" />
    <title>Workcraft - tutorial:modelling:petri_net:start</title>
    <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="tutorial,modelling,petri net,start"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../lib/exe/opensearch.html" title="Workcraft"/>
<link rel="start" href="start.html"/>
<link rel="contents" href="start.html" title="Sitemap"/>
<link rel="alternate" type="application/rss+xml" title="Changes" />
<link rel="alternate" type="application/rss+xml" title="Current namespace" />
<link rel="edit" title="Edit this page" href="start.html"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="../../_export/xhtml/tutorial/modelling/petri_net/start.xhtml"/>
<link rel="alternate" type="text/plain" title="Wiki Markup" href="../../_export/raw/tutorial/modelling/petri_net/start.raw"/>
<link rel="canonical" href="http://www.workcraft.org/tutorial/modelling/petri_net/start"/>
<link rel="stylesheet" type="text/css" href="../../lib/exe/css.php.t.dokuwiki-light-export.css"/>
<script type="text/javascript">/*<![CDATA[*/var NS='tutorial:modelling:petri_net';var SIG=' --- //[[danilovesky@gmail.com|Danil Sokolov]] 2015/12/23 22:41//';var JSINFO = {"id":"tutorial:modelling:petri_net:start","namespace":"tutorial:modelling:petri_net","plugin_folded":{"hide":"hide","reveal":"reveal"}};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../lib/exe/js.php.t.dokuwiki-light-export.js"></script>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="shortcut icon" href="../../favicon.ico" />
<link rel="apple-touch-icon" href="../../apple-touch-icon.png" />
    </head>

<body>
    <!--[if lte IE 7 ]><div id="IE7"><![endif]--><!--[if IE 8 ]><div id="IE8"><![endif]-->
    <div id="dokuwiki__site"><div id="dokuwiki__top" class="site dokuwiki mode_show tpl_dokuwiki-light-export loggedIn    ">

        
<!-- ********** HEADER ********** -->
<div id="dokuwiki__header"><div class="pad group">

        <h1><a href="../../start.html"  title="Workcraft start page"><img src="../../logo.png" width="327" height="57" alt="" /></a></h1>
    <br><br><br><br>
    <div class="tools group">
        <!-- USER TOOLS -->
<!--
                    <div id="dokuwiki__usertools">
                <h3 class="a11y">User Tools</h3>
                <ul>
                    <li><a href="start.html"  class="action admin" rel="nofollow" title="Admin">Admin</a></li><li><a href="start.html"  class="action profile" rel="nofollow" title="Profile">Profile</a></li><li><a href="start.html"  class="action logout" rel="nofollow" title="Logout">Logout</a></li>                </ul>
            </div>
        -->

        <!-- SEARCH TOOLS -->
<!--
        <div id="dokuwiki__searchtools">
            <h3 class="a11y"></h3>
            <form action="../../start.html" accept-charset="utf-8" class="search" id="dw__search" method="get" role="search"><div class="no"><input type="hidden" name="do" value="search" /><input type="text" id="qsearch__in" accesskey="f" name="id" class="edit" title="[F]" /><input type="submit" value="Search" class="button" title="Search" /><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>        </div>
-->

        <!-- SITE TOOLS -->
<!--
        <div id="dokuwiki__sitetools">
            <h3 class="a11y">Site Tools</h3>
                            <div class="mobileTools">
                    <form action="../..//doku.html.doku.php.html" method="get" accept-charset="utf-8"><div class="no"><input type="hidden" name="id" value="tutorial:modelling:petri_net:start" /><input type="hidden" name="sectok" value="a0626b04e6394048dbff79259066cd8c" /><select name="do" class="edit quickselect" title="Tools"><option value="">Tools</option><optgroup label="Page Tools"><option value="edit">Edit this page</option><option value="revisions">Old revisions</option><option value="backlink">Backlinks</option></optgroup><optgroup label="Site Tools"><option value="recent">Changes</option><option value="media">Manager</option><option value="index">Sitemap</option></optgroup><optgroup label="User Tools"><option value="logout">Logout</option><option value="profile">Profile</option><option value="admin">Admin</option></optgroup></select><input type="submit" value="&gt;" /></div></form>                </div>
                <ul>
                    <li><a href="start.html"  class="action recent" accesskey="r" rel="nofollow" title="Changes [R]">Changes</a></li><li><a href="start.html"  class="action media" rel="nofollow" title="Manager">Manager</a></li><li><a href="start.html"  class="action index" accesskey="x" rel="nofollow" title="Sitemap [X]">Sitemap</a></li>                </ul>
                    </div>
    </div>
-->

    <!-- BREADCRUMBS -->
        
    <hr class="a11y" />
</div></div><!-- /header -->

        <div class="wrapper group">

            
            <!-- ********** CONTENT ********** -->
            <div id="dokuwiki__content"><div class="pad group">
                <div class="pageId"><span>tutorial:modelling:petri_net:start</span></div>
                <div class="page group">
                                                            <!-- wikipage start -->
                    <!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="#modelling">Modelling</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="#task_1">Task 1</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="#simulation">Simulation</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="#task_2">Task 2</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="#verification">Verification</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="#task_3">Task 3</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="#solutions">Solutions</a></div></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 id="modelling_with_petri_netsdining_philosophers">Modelling with Petri nets: Dining philosophers</h1>
<div class="level1">

<p>
In this tutorial we will use the famous <a href="http://en.wikipedia.org/wiki/Dining_philosophers_problem" class="interwiki iw_wp" title="http://en.wikipedia.org/wiki/Dining_philosophers_problem">Dining philosophers problem</a> to illustrate the power and convenience of the Petri nets. The problem states that there are five philosophers sitting around a table. Each philosopher either thinks or eats. There are five forks on the table shared among philosophers in such a way that each fork can be either used by a philosopher on its left or on its right. Before eating a philosopher tries to take both forks in some order. If a fork is already taken by a neighbouring philosopher, he will be waiting until the fork becomes available again. After eating, a philosopher returns to thinking while putting back both of his forks. 
</p>

</div>

<h2 id="modelling">Modelling</h2>
<div class="level2">

<p>
Petri nets is an ideal tool for formally modelling the dining philosophers problem. The behaviour of a single philosopher can be modelled with <code>take_left_fork</code>, <code>put_left_fork</code>, <code>take_right_fork</code>,  <code>put_right_fork</code>, <code>start_eating</code> and <code>start_thinking</code> transitions. The state of the philosopher is captured with a token in either the <code>eating</code> or <code>thinking</code> place and the availability of forks is determined by the presence of a token in <code>fork1_free</code> and <code>fork2_free</code> places respectively (the corresponding fork is on the table), as shown in the following Petri net. 
</p>

<p>
<img src="pn-philosopher.png" class="mediacenter" alt="" />
</p>

<p>
For simplicity let us model the problem with two philosophers and two forks only. In this case, the <code>fork1_free</code> and <code>fork2_free</code> are shared by the philosophers <em>A</em> and <em>B</em> as modelled by the following Petri net.
</p>

<p>
<img src="pn-two_philosophers.png" class="mediacenter" alt="" />
</p>
<div class="wrap_box plugin_wrap">
<h3 id="task_1">Task 1</h3>

<p>
Capture this Petri net within Workcraft. You may want to build a Petri net model of a single philosopher first, put it in a group, and then make use of copy-paste features to replicate the model for the other philosopher. Give the places and transitions some meaningful names, e.g. as in the Petri net above. As the names of places and transitions must be unique, we prepended the node names  with <em>A_</em> and <em>B_</em> prefixes to distinguish the models of philosophers <em>A</em> and <em>B</em> respectively.
</p>

<p>
You can make use of the <em>Transformations→Merge selected places</em> to glue together the places representing the same forks.
</p>
</div><div class="wrap_tip plugin_wrap">
<p>
Note the difference between the names and labels:
</p>
<ul>
<li class="level1"><div class="li">
 A name is a unique alpha-numerical ID of a Petri net node which is used as the node reference in simulation and verification.
</div></li>
<li class="level1"><div class="li">
 A label is just an arbitrary text attached to a node. 
</div></li>
</ul>

</div>
</div>

<h2 id="simulation">Simulation</h2>
<div class="level2">

<p>
Enter the simulation tool by pressing the <img src="../../help/editor_tools-simulate.png" class="media" title="[M] Simulate" alt="[M] Simulate" /> button and play with the dining philosophers model. Initially both forks are on the table and places <code>fork1_free</code> and <code>fork2_free</code> are marked. Each philosopher can take any of the forks - the corresponding <code>*_take_left_fork</code> and <code>*_take_right_fork</code> transitions are enabled for both philosophers. 
</p>

<p>
If you allow the same philosopher to take both forks (e.g., by clicking transitions <code>A_take_left_fork</code> and <code>A_take_right_fork</code>), then he can eat, while the other philosopher thinks. When he is finished with the meal he enters the thinking state (click transition <code>A_start_thinking</code>) and returns the forks (click transitions <code>A_put_left_fork</code> and <code>A_put_right_fork</code>). This trace of transitions brings us to the initial state where the philosophers compete for the forks again.
</p>

<p>
Another scenario is possible when each philosopher takes only one of the forks (e.g. click transitions <code>A_take_left_fork</code> and <code>B_take_right_fork</code>)). This leads to a deadlock as the philosophers wait for each other to return the fork, but none of them can do it until they eat.
</p>
<div class="wrap_box plugin_wrap">
<h3 id="task_2">Task 2</h3>
<ul>
<li class="level1"><div class="li">
 Simulate the above distinctive scenarios for dining philosophers. 
</div></li>
<li class="level1"><div class="li">
 Explore the navigation buttons in the <em>Control panel</em> and go back and forth through the trace of events in your simulation. 
</div></li>
<li class="level1"><div class="li">
 Try random simulation at different animation speeds.
</div></li>
</ul>

</div>
</div>

<h2 id="verification">Verification</h2>
<div class="level2">

<p>
Various properties of a Petri net model can be verified using <em>punf</em> and <em>mpsat</em> as the backend tools (see overview of <a href="../../overview/backend_tools.html" class="wikilink1" title="overview:backend_tools">third-party tools</a> for more details). The tool interfaces available for Petri net verification are collected under <em>Verification</em> menu.
</p>

<p>
The easiest and most obvious property to check is that the model does not have a deadlock - choose the <em>Verification→Deadlock [MPSat]</em> menu item for this. A our dining philosophers model is not deadlock-free, this should result in the following error message with a trace leading to the deadlock (you can play in the simulator by clicking the <em>Play</em> button).
</p>

<p>
<img src="deadlock_trace-two_philosophers.png" class="mediacenter" alt="" />
</p>

<p>
Verification of custom properties is based on reachability analysis on the Petri net. For this a custom property should  be expressed in <a href="../../help/reach.html" class="wikilink1" title="help:reach">Reach language</a>. For example, you can try and verify that both philosophers cannot be eating at the same time:
</p>
<ul>
<li class="level1"><div class="li">
 Open <em>Custom property definition</em> window via <em>Verification→Custom properties [MPSat]…</em>.
</div></li>
<li class="level1"><div class="li">
 In <em>MPSat settings</em> set the <em>Mode</em> into <em>Reachability analysis</em> and the <em>Solution</em> into <em>minimise cost function</em>.
</div></li>
<li class="level1"><div class="li">
 Enter the following Reach expression as the property predicate: <code>$P&quot;A_eating&quot; &amp; $P&quot;B_eating&quot;</code>.
</div></li>
<li class="level1"><div class="li">
 Select <em>unsatisfiable</em> to denote that the property holds if predicate is unsatisfiable.
</div></li>
<li class="level1"><div class="li">
 Save this property as a preset for future use (<em>Save as…</em> button), e.g. under the name <em>simultaneous eating</em>.
</div></li>
</ul>


<p>
The result should be similar to the following screenshot.
<img src="property_check-two_philosophers-never_eat_simultaneously.png" class="mediacenter" alt="" />
</p>

<p>
Let us explain how to interpret the Reach predicate. Consider an expression <code>$P&quot;place_name&quot;</code>. It instructs MPSat to check if a marking is reachable where the place <code>place_name</code> has a token. In basic cases one can apply logical operations and quantifiers (e.g. <code>&amp;</code>, <code>|</code>, <code>forall</code>, <code>existis</code>, etc.) to a marking which violates the property. For expressing more sophisticated properties refer to <a href="../../help/reach.html" class="wikilink1" title="help:reach">Reach language documentation</a>.
</p>

<p>
In our case, the expression <code>$P&quot;A_eating&quot; &amp; $P&quot;B_eating&quot;</code> tells MPSat to check if a state is reachable where both places <code>A_eating</code> and <code>B_eating</code> are marked with tokens, which corresponds to both philosophers eating at the same time. If such a marking is reachable, then our property is violated and a trace of Petri net transitions leading to this state is reported. If this Petri net marking is not reachable, then the property holds, as shown in the following screenshot.
</p>

<p>
<img src="property_satisfied-two_philosophers-never_eat_simultaniously.png" class="mediacenter" alt="" />
</p>
<div class="wrap_tip plugin_wrap">
<p>
Note that the Reach expression is usually formulated as the negation of the property one wants to check. If there is no reachable state satisfying this negation then the property itself is satisfied by all the reachable states.
</p>
</div><div class="wrap_box plugin_wrap">
<h3 id="task_3">Task 3</h3>
<ul>
<li class="level1"><div class="li">
 Verify the model of dining philosophers for deadlocks. Simulate the trace leading to the deadlock. 
</div></li>
<li class="level1"><div class="li">
 Modify the model in such a way that the deadlock is prevented (hint: <span class="wrap_spoiler ">force the philosophers to take the forks in particular order, one of them always takes the fork to his left first, while the other always takes the fork to his right first</span>).
</div></li>
<li class="level1"><div class="li">
 Verify that none of the philosophers can be eating with one of the forks still on the table (hint: <code><span class="wrap_spoiler ">($P&quot;A_eating&quot; | $P&quot;B_eating&quot;) &amp; ($P&quot;fork1_free&quot; | $P&quot;fork2_free&quot;)</span></code>).
</div></li>
</ul>

</div>
</div>

<h2 id="solutions">Solutions</h2>
<div class="level2">

<p>
Download all the Workcraft models discussed in this section here:
</p>

<p>
<span class="wrap_download "><a href="dining_philosophers.tar.gz" class="media mediafile mf_gz" title="tutorial:modelling:petri_net:dining_philosophers.tar.gz (14.7 KB)">Dining philosophers models</a> (14.74 KiB, <acronym title="Modified: 2014-06-20 22:28.15">1y ago</acronym>)</span>
</p>

</div>

                    <!-- wikipage stop -->
                                    </div>
<!--
                                    <div class="docInfo"><bdi>tutorial/modelling/petri_net/start.txt</bdi> · Last modified: 2015/12/11 14:44 by <bdi>victor</bdi></div>
                -->
                            </div></div><!-- /content -->

            <hr class="a11y" />

            <!-- PAGE ACTIONS -->
<!--
            <div id="dokuwiki__pagetools">
                            <h3 class="a11y">Page Tools</h3>
                <div class="tools">
                    <ul>
                        <li><a href="start.html"  class="action edit" accesskey="e" rel="nofollow" title="Edit this page [E]"><span>Edit this page</span></a></li><li><a href="start.html"  class="action revs" accesskey="o" rel="nofollow" title="Old revisions [O]"><span>Old revisions</span></a></li><li><a href="start.html"  class="action backlink" rel="nofollow" title="Backlinks"><span>Backlinks</span></a></li><li><a href="#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Back to top [T]"><span>Back to top</span></a></li><li><a href="start.html"  class="action export_pdf" rel="nofollow" title="Export to PDF"><span>Export to PDF</span></a></li><li><a href="start.html"  class="action siteexport_addpage" title="Add page"><span>Export Page</span></a></li>                    </ul>
                </div>
                        </div>
-->
        </div><!-- /wrapper -->

        
<!-- ********** FOOTER ********** -->
<div id="dokuwiki__footer"><div class="pad">
    <!--
    <div class="buttons">
                <a href="http://www.dokuwiki.org/donate" title="Donate" ><img
            src="../../lib/tpl/dokuwiki-light-export/images/button-donate.gif" width="80" height="15" alt="Donate" /></a>
        <a href="http://www.php.net" title="Powered by PHP" ><img
            src="../../lib/tpl/dokuwiki-light-export/images/button-php.gif" width="80" height="15" alt="Powered by PHP" /></a>
        <a href="http://validator.w3.org/check/referer" title="Valid HTML5" ><img
            src="../../lib/tpl/dokuwiki-light-export/images/button-html5.png" width="80" height="15" alt="Valid HTML5" /></a>
        <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" ><img
            src="../../lib/tpl/dokuwiki-light-export/images/button-css.png" width="80" height="15" alt="Valid CSS" /></a>
        <a href="http://dokuwiki.org/" title="Driven by DokuWiki" ><img
            src="../../lib/tpl/dokuwiki-light-export/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" /></a>
    </div>
-->

<!--
    <div class="userInfo">
        Logged in as:: danil    </div>
-->
</div></div><!-- /footer -->

    </div></div><!-- /site -->

    <div class="no"><img  width="2" height="1" alt="" /></div>
    <div id="screen__mode" class="no"></div>    <!--[if ( lte IE 7 | IE 8 ) ]></div><![endif]-->
</body>
</html>

